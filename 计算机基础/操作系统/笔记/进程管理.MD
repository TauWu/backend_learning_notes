# 进程管理

## 进程和线程
- 进程概念
    >- 进程是指一个具有一定独立功能的程序在一个数据集合上的一次动态执行的过程
    >- 进程包含了一个正在运行的程序的所有状态信息：`代码`、`数据`、`状态寄存器`、`通用寄存器`和`进程占用系统资源` => 进程控制块
    >- 进程是操作系统处于执行状态程序的抽象
    >- 程序 => 文件
    >- 进程 => 执行中的文件 => 程序 + 执行状态
- 进程的状态与转换
    - 进程创建：系统初始化时，用户请求创建一个新的进程 或 正在运行的进程申请创建新的进程。
    - 进程执行：内核通过调度算法选择一个就绪的进程开始执行。
    - 进程等待：请求并等待系统服务 或 启动过某种操作，导致无法马上完成进程的等待；比如需要的数据没有到达的等待。
    - 进程抢占：高优先级的进程就绪 或 当前执行的进程执行时间用完，被其他进程抢占。
    - 进程唤醒：被阻塞的进程需要的资源被满足；被阻塞的进程等待的事件到达（进程只能被其他进程或者操作唤醒，不能自身唤醒）
    - 进程结束：将进程占用的资源释放给操作系统（包括正常退出、错误退出、致命错误和被其它进程所杀等）
- 进程的控制与组织
    - 进程控制块：操作系统管理和控制进程运行所用的信息的集合
        >- 进程控制块包括进程的基本信息（ID、程序） 和进程的变化过程（进程状态）
        >- PCB是进程存在的唯一标示，每个进程在操作系统中都有唯一的PCB，PCB存放了 标识信息、处理机现场保存、进程控制信息等。
        >- 进程地址空间包括：段表、共享库、栈、堆、初始化数据和代码 
    - 调度队列和调度器**TODO**
    - 进程的创建和终止
        - 进程切换
            - 暂停当前运行的程序，从运行状态变为其他状态，调度另一个进程从就绪状态变为运行状态
            - 要求：切换前需要保证进程的上下文，切换后要恢复进程的上下文。切换速度要尽可能的快。
            - 要保存的信息：寄存器信息、CPU状态信息、内存地址空间
        - 进程创建
            - idleproc -> 分配idleproc需要的资源 -> 初始化PCB -> 完成初始化过程
            - fork()复制进程 -> exec()修改进程
            - pid -> 子进程的ppid
        - 进程等待和退出
            - 进程结束的时候调用exit(),完成对进程资源的回收
            >- 资源回收的内容包括：将调用参数作为进程的结果结束、关闭所有打开的文件等占用资源、释放内存、释放大部分进程相关的内核数据结构、检查父进程是否存活（如果存活则保留返回值直到父进程需要，子进程进入僵尸状态；如果不存活，释放所有数据结构，进程结束）、清理所有处理等待状态的僵尸进程
            - 父进程在wait()的收检查子进程是否存活
- 进程概念与多线程模型
    - 作用：进程内部进一步提高并发性，线程间能直接通信和共享数据
    - 多线程的解决思路：实体间可以并发执行，实体间可以共享相同的地址，这种实体就是线程
    - 概念：线程是进程的一部分，描述指令流的执行状态。它是进程中指令流的最小单位，是CPU调度的基本单位。
    - 优点：一个线程中可以存在多个线程；各个线程之间可以并发执行；各个线程之间可以共享地址空间和文件等资源。
    - 缺点：一个线程的崩溃会导致该进程下面的所有线程的崩溃。

## CPU调度
- 调度的基本概念
- 调度时机、切换与过程
- 调度的基本准则
- 调度方式
- 典型调度算法

## 同步与互斥
- 进程间的三种关系
- 进程同步和临界区的基本概念
- 信号量
- 使用信号量描述和解决经典同步问题

## 死锁
- 死锁的概念
- 死锁的处理策略
- 死锁预防（限制申请的方式）
- 死锁避免（利用额外的先验信息，在分配资源前判断是否会出现死锁，只在不会死锁时分配资源）
- 死锁的检测和解除

